/*!
 * iframemanager v1.2.5
 * Author Orest Bida
 * Released under the MIT License
 */
(()=>{const e='click',t='{data-id}',n='accept',o='reject',c='c-h-n',i='c-h-b',r='show-ph';let s,a,l,f,d,u={},v={},m={},p='',h={},b=new Map,w='api';const _=['onload','onerror','src','params'],g=e=>'function'==typeof e,$=e=>'string'==typeof e,S=e=>a.createElement(e),T=()=>S('div'),x=()=>{const e=S('button');return e.type='button',e},y=(e,t)=>e.className=t,I=(e,t)=>e.classList.add(t),P=(e,t)=>e.appendChild(t),D=e=>e&&Object.keys(e)||[],E=(e,t)=>{for(const n in t)k(e,n,t[n])},M=e=>{const t=e.dataset,n={},o='data-iframe-',c=e.getAttributeNames().filter((e=>e.slice(0,12)===o)).map((e=>e.slice(12))),i=e.querySelector('[data-placeholder]'),r=i&&i.hasAttribute('data-visible');r&&i.removeAttribute('data-visible');const s=i&&i.cloneNode(!0);for(const a of c)n[a]=e.getAttribute(o+a);return{t:t.id,o:t.title,i:t.thumbnail,l:t.params,u:e,v:null,m:i,p:s,h:null,_:!1,$:!1,S:!0,T:'widget'in t,I:r,P:n}},O=(e,t)=>{const n=u[e];if('IntersectionObserver'in s){const e=new IntersectionObserver((o=>{for(const c of o)c.isIntersecting&&(j(t,n[c.target.dataset.index]),e.unobserve(c.target))}));for(const t of n)e.observe(t.u)}},j=(e,n)=>{const o=e=>{n.h.style.backgroundImage=`url('${e}')`;const t=new Image;t.onload=()=>I(n.h,'loaded'),t.src=e};if($(n.i))''!==n.i&&o(n.i);else if(g(e))e(n.t,(e=>o(e)));else if($(e)){const c=e.replace(t,n.t);o(c)}},C=(e,n)=>{if(e._)return;if(e._=!0,e.m){const t=e.p.cloneNode(!0);e.m.replaceWith(t),e.m=t}const o=n.iframe;if(g(n.onAccept))return void n.onAccept(e.u,(t=>{if(!(t instanceof HTMLIFrameElement))return!1;E(t,o),E(t,e.P),e.D=t,e._=!0,I(e.u,i),(!e.I||e.T)&&I(e.u,r)}));e.D=S('iframe');const c=n.iframe,s=e.l||c&&c.params;let a=(n.embedUrl||'').replace(t,e.t);e.o&&(e.D.title=e.o),s&&$(s)&&(a+='?'===s.slice(0,1)?s:`?${s}`),e.D.onload=()=>{I(e.u,i),e.D.onload=void 0,g(o&&o.onload)&&o.onload(e.t,e.D)},E(e.D,o),E(e.D,e.P),e.D.src=a,P(e.v,e.D)},k=(e,t,n)=>{_.includes(t)||e.setAttribute(t,n)},L=e=>{I(e.u,c),e.S=!1},N=e=>{e.u.classList.remove(c,i,r),e.S=!0},A=(e,t)=>{if(g(t.onGetCookie))return t.onGetCookie(t.category,e);const n=a.cookie.match(`(^|;)\\s*${t.cookie.name}\\s*=\\s*([^;]+)`);return n?n.pop():''},F=(t,n,o)=>{const i=u[t],r=n.languages;i.forEach((i=>{if(!i.$&&r){const s=r[p],l=s&&s.loadBtn,f=s&&s.notice,d=s&&s.loadAllBtn,u=a.createElement('div'),v=T(),m=T(),h=T(),b=T();y(u,'cll'),i.v=u;const _=()=>{L(i),C(i,n)};if(l){const t=x();t.textContent=l,y(t,'c-l-b'),t.addEventListener(e,_),P(b,t)}if(d){const n=x();n.textContent=d,y(n,l?'c-la-b':'c-l-b'),n.addEventListener(e,(()=>{_(),w=e,q.acceptService(t)})),P(b,n)}const g=T(),D=T(),E=T(),M=T(),O=T();y(g,'cc-text'),y(M,'c-bg-i'),i.h=M,y(E,'c-ld'),$(i.i)&&''===i.i||y(D,'c-bg');const j=i.o,k=a.createDocumentFragment();if(j){const e=S('span');y(e,'c-tl'),e.insertAdjacentHTML('beforeend',j),P(k,e)}P(g,k),v&&g.insertAdjacentHTML('beforeend',f||''),P(m,g),y(O,'c-t-cn'),y(m,'c-n-t'),y(h,'c-n-c'),y(v,'c-nt'),y(b,'c-n-a'),P(O,m),(l||d)&&P(O,b),P(h,O),P(v,h),P(D,M),P(u,v),(n.thumbnailUrl||i.i)&&P(u,D),P(u,E),o&&I(i.u,c),i.u.prepend(u),i.$=!0,setTimeout((()=>I(i.u,'c-an')),20)}}))},G=(e,t)=>{const n=u[e];n.forEach((o=>{o._||((e,o)=>{v[o]||(v[o]=new IntersectionObserver((e=>{if(m[o])v[o].disconnect();else for(let c=0;c<e.length;++c)e[c].isIntersecting&&(c=>{const i=e[c].target,r=i.dataset.index;C(n[r],t),setTimeout((()=>{L(n[r])}),50*c),v[o].unobserve(i)})(c)}))),v[o].observe(e)})(o.u,e)}))},H=(e,t)=>e in t?e:D(t).length>0?p in t?p:D(t)[0]:void 0,J=(e,t)=>{A(e,t)||((e,t)=>{if(g(t.onGetCookie))return void t.onSetCookie(t.category,e,t.cookie);const{hostname:n,protocol:o}=location,c=t.cookie.name,i=new Date,r=t.cookie.path||'/',s=864e5*(t.cookie.expiration||182),l=t.cookie.sameSite||'Lax',f=t.cookie.domain||n;i.setTime(i.getTime()+s);let d=c+'=1'+(0!==s?`; Expires=${i.toUTCString()}`:'')+`; Path=${r}`+`; SameSite=${l}`;f.indexOf('.')>-1&&(d+=`; Domain=${f}`),'https:'===o&&(d+='; Secure'),a.cookie=d})(e,t),G(e,t)},V=(e,t)=>{A(e,t)&&((e,t)=>{if(g(t.onGetCookie))return void t.onGetCookie(t.category,e,t.cookie);const n=t.cookie.name,o=t.cookie.path||'/',c=t.cookie.domain||location.hostname;a.cookie=`${n}=; Path=${o}; Domain=${c}; Expires=Thu, 01 Jan 1970 00:00:01 GMT;`})(e,t),((e,t)=>{const n=u[e];for(let o=0;o<n.length;o++)(e=>{var o;n[e]._&&(g(t.onReject)?(t.onReject(n[e].D,n[e].u,(()=>N(n[e]))),n[e]._=!1):((o=n[e]).D&&o.D.remove(),o._=!1)),N(n[e])})(o)})(e,t)},W=(e,t,n)=>{g(d)&&d({eventSource:{type:w,service:e,action:t},changedServices:n})},q={acceptService:e=>{const t=[];if('all'===e){for(const e of f)m[e]=!1,b.get(e)||(b.set(e,!0),J(e,h[e]),t.push(e));t.length>0&&W(e,n,t)}else f.includes(e)&&(m[e]=!1,b.get(e)||(b.set(e,!0),J(e,h[e]),t.push(e),W(e,n,t)));w='api'},rejectService:e=>{const t=[];if('all'===e){for(const e of f)m[e]=!0,V(e,h[e]),b.get(e)&&(b.set(e,!1),t.push(e));t.length>0&&W(e,o,t)}else f.includes(e)&&(m[e]=!0,V(e,h[e]),b.get(e)&&(b.set(e,!1),t.push(e),W(e,o,t)))},childExists:async({parent:e=s,childProperty:t,childSelector:n='iframe',timeout:o=1e3,maxTimeout:c=15e3})=>{let i=1;const r=t?()=>e[t]:()=>e.querySelector(n);return new Promise((e=>{const t=()=>{if(r()||i++*o>c)return e(void 0!==r());setTimeout(t,o)};t()}))},getState:()=>({services:new Map(b),acceptedServices:[...b].filter((([,e])=>!!e)).map((([e])=>e))}),getConfig:()=>l,run:e=>{if(a=document,s=window,l=e,h=l.services,d=l.onChange,f=D(h),0===f.length)return;p=l.currLang;const t=h[f[0]].languages;!0===l.autoLang?p=H(navigator.language.slice(0,2).toLowerCase(),t):$(l.currLang)&&(p=H(l.currLang,t));for(const n of f){const e=h[n],t=e.cookie=e.cookie||{};t.name=t.name||`im_${n}`;const o=A(n,e);b.set(n,!!o),u[n]=[];const c=a.querySelectorAll(`div[data-service="${n}"]`),i=c.length;if(0!==i){for(let e=0;e<i;e++)c[e].dataset.index=e,u[n].push(M(c[e]));o?(F(n,e,!0),G(n,e)):F(n,e,!1),O(n,e.thumbnailUrl)}}}},z='iframemanager';'undefined'==typeof window||g(window[z])||(window[z]=()=>q)})();
